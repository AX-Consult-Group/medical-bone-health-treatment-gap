[
  {
    "objectID": "poe_bone_health.html",
    "href": "poe_bone_health.html",
    "title": "Bone Health - Screening & Treatment Gap",
    "section": "",
    "text": "Show code\nlibrary(pacman)\np_load(magrittr, tidyverse, psych, dplyr, ggplot2, haven, janitor, readxl, writexl, knitr, kableExtra, scales, tibble, tidyr)\n\n\n\nBackground\nThis project examines bone health in adults using survey data from the NHANES data library, with a focus on identifying individuals at an elevated risk of osteoporosis. Current screening criteria consider only gender and age and are therefore limited. Bone mineral density measurements and common risk indicators were used to characterize patterns of risk across age and gender groups. The analysis also explores how current age-based screening recommendations may miss individuals with meaningful bone-health risk.\n\n\nAim\nThe findings aim to support earlier identification of high-risk populations and inform more targeted approaches to bone-health assessment.\n\n\nMethods\nThis analysis used publicly available data from the 2005–2006 National Health and Nutrition Examination Survey (NHANES). Demographic, body measurement, dual-energy X-ray absorptiometry (DXA) bone density, osteoporosis history, smoking, and physical activity datasets were merged at the individual level using the NHANES respondent identifier. Bone-health risk was defined using lumbar spine DXA measures and established clinical thresholds, supplemented by well-recognized behavioral and clinical risk factors. All analyses were descriptive and exploratory, intended to characterize screening gaps rather than to support clinical diagnosis.\n\n\nData Cleaning\n\nReading in data\nMultiple NHANES data sets were integrated in this analysis, including demographic information, body measurements, DXA bone density measurements, osteoporosis and fracture history, smoking behavior, and physical activity data. Together, these data sets provide a comprehensive view of bone health, relevant risk factors, and population-level screening patterns across adults.\n\n\nDXA cleaning\nThe NHANES DXA data include multiple imputed records per participant (due to missing data). While formal epidemiologic analyses would typically run analyses on all imputations, this analytics exercise used a single imputation (MULT = 1). Furthermore, observations were excluded if they did not complete a full and valid exam (DXAEXSTS = 1).\n\n\nShow code\n# Selecting single imputation and removing incomplete exam data\ndxa_clean &lt;- dxa %&gt;%\n  dplyr::filter(`_MULT_` == 1) %&gt;% \n  dplyr::filter(DXAEXSTS == 1)\n\n\n\n\nVariable selection\nRelevant variables were selected from each NHANES data set to support the assessment of bone health, fracture risk, and screening eligibility. Demographic variables were used to characterize the study population and define age- and gender-based screening criteria. Body measurement variables provided objective indicators of body mass, which is a known risk factor for low bone density. DXA-derived bone mineral density measures were used to characterize skeletal health, with lumbar spine density serving as the primary site for bone-risk classification. Osteoporosis, smoking, and physical activity variables were included to capture established clinical and lifestyle risk factors associated with fracture risk.\nAll variables were selected based on their clinical relevance, availability in the NHANES 2005–2006 cycle, and suitability for population-level risk stratification rather than individual diagnosis.\nSeveral derived variables were created from the selected NHANES variables to support bone-health risk stratification.\nLow body mass index (low_bmi) was defined as a body mass index (BMI) below 18.5 kg/m². This threshold reflects underweight status and is a well-established risk factor for reduced bone density and increased fracture risk.\nLumbar spine T-score (tscore_spine) was calculated by standardizing lumbar spine BMD using published reference values for young healthy adults (Xue et al., 2021). The resulting T-score represents the number of standard deviations an individual’s bone density differs from the reference mean and allows alignment with widely used clinical conventions. Based on this T-score, spine_class was defined to indicate normal bone density, osteopenia, or osteoporosis using conventional cut-points (≥ −1.0, −1.0 to −2.5, and ≤ −2.5, respectively). These classifications are used for contextual interpretation and not for clinical diagnosis.\nPrior fracture history (prior_fracture) was defined as a history of self-reported fracture at the hip, wrist, or spine. Individuals reporting a fracture at any of these sites were flagged as having a prior fracture, which is a strong indicator of future fracture risk.\nSmoking status (smoker_status) was derived using a combination of lifetime smoking history and current smoking behavior. Individuals who reported never having smoked at least 100 cigarettes in their lifetime were classified as never smokers. Those who had smoked at least 100 cigarettes and reported currently smoking every day or on some days were classified as current smokers. Individuals who had smoked at least 100 cigarettes but reported not currently smoking were classified as former smokers. This categorization reflects cumulative smoking exposure relevant to bone health rather than short-term smoking behavior.\nLow physical activity (low_activity) was defined as reporting neither moderate nor vigorous physical activity during the past 30 days. Low levels of physical activity are associated with reduced mechanical loading of bone and increased fracture risk, particularly in older adults.\nTogether, these derived variables provide clinically meaningful and interpretable indicators of bone-health risk that support population-level cohort definition and analysis without implying individual-level diagnosis.\n\n\nShow code\n# Variable selection \n\n# Bio\nbio_sel &lt;- bio %&gt;%\n  dplyr::select(\n    SEQN,         # ID\n    RIDAGEYR,     # age (years)\n    RIAGENDR,     # gender (1 = male, 2 = female)\n    RIDRETH1,     # race\n    WTMEC2YR      # statistical exam weight \n  )\n\n# bmx\nbmx_sel &lt;- bmx %&gt;%\n  dplyr::select(\n    SEQN,         # ID\n    BMXBMI        # BMI \n  ) %&gt;%\n  mutate(\n    low_bmi = if_else(BMXBMI &lt; 18.5, 1, 0)\n  )\n\n# dxa\n\n# Reference values for T-scores\nref_spine_mean   &lt;- 1.065\nref_spine_sd     &lt;- 0.122\n\ndxa_sel &lt;- dxa_clean %&gt;%\n  dplyr::select(\n    SEQN,         # ID\n    DXXLSBMD,     # Lumbar Spine BMD (g/cm^2)\n  ) %&gt;% \n    mutate(\n    # Calculate T-scores\n    tscore_spine   = (DXXLSBMD   - ref_spine_mean)   / ref_spine_sd,\n    \n    spine_class = case_when(\n      tscore_spine &gt;= -1.0 ~ 0,                       # 0 = normal\n      tscore_spine &lt; -1.0 & tscore_spine &gt; -2.5 ~ 1,  # 1 = osteopenia\n      tscore_spine &lt;= -2.5 ~ 2,                       # 2 = osteoporosis\n      TRUE ~ NA_real_\n    )\n  )\n\n\n# osteo\nosteo_sel &lt;- osteo %&gt;%\n  dplyr::select(\n    SEQN,     # ID\n    OSQ010A,  # broken/fractured hip (yes = 1, no = 2)\n    OSQ010B,  # broken/fractured wrist\n    OSQ010C,  # broken/fractured spine\n    OSQ060   # \"Ever told had osteoporosis/brittle bones\"\n  ) %&gt;%\n  mutate(\n    prior_fracture = if_else(OSQ010A == 1 | OSQ010B == 1 | OSQ010C == 1, 1, 0)\n  )\n\n# smoke\nsmoke_sel &lt;- smoke %&gt;%\n  dplyr::select(\n    SEQN,       # ID\n    SMQ020,     # smoked at least 100 cigarettes in life (yes = 1, no = 2)\n    SMD030,     # Age started smoking cigarettes regularly\n    SMQ040,     # Do you now smoke cigarettes (1 = everyday, 2 = some days, 3 = not at all)\n  ) %&gt;% \n  mutate(\n    smoker_status = case_when(\n      SMQ020 == 2 ~ 0,                          # Never smoker\n      SMQ020 == 1 & SMQ040 %in% c(1, 2) ~ 1,    # Current smoker\n      SMQ020 == 1 & SMQ040 == 3 ~ 2,            # Former smoker\n      TRUE ~ NA_real_                           # Missing/other\n    )\n  )\n\n# activity\nactivity_sel &lt;- activity %&gt;%\n  dplyr::select(\n    SEQN,       # ID\n    PAD200,     # Vigorous activity over past 30 days (1 = yes, 2 = no, 3 = unable)\n    PAD320,     # Moderate activity over past 30 days (1 = yes, 2 = no, 3 = unable)\n  ) %&gt;% \n  mutate(\n    low_activity = if_else(\n      PAD200 == 2 & PAD320 == 2,  # no vigorous AND no moderate activity\n      1, 0\n    )\n  )\n\n\n\n\nMerging\nThe selected NHANES data sets were merged into a single analytic data set to enable integrated analysis across bone density measurements, demographic characteristics, and relevant risk factors. All data sets were linked using the NHANES respondent sequence number, which uniquely identifies each participant across survey components. Bone density data served as the anchor for the merged data set, ensuring that all included individuals had valid DXA measurements. Additional data from demographic, body measurement, osteoporosis, smoking, and physical activity components were joined to enrich the analytic data set with clinically relevant context while preserving one record per participant.\n\n\nShow code\n# Merging of data sets\n\ndata &lt;- bio_sel %&gt;%\n  inner_join(dxa_sel,  by = \"SEQN\") %&gt;%  \n  left_join(bmx_sel,   by = \"SEQN\") %&gt;%\n  left_join(osteo_sel, by = \"SEQN\") %&gt;%\n  left_join(smoke_sel, by = \"SEQN\") %&gt;%\n  left_join(activity_sel, by = \"SEQN\") \n\n\n\n\nFinal cleaning\nThe analysis was restricted to adults aged 20 years and older. Several risk proxy variables (e.g., smoking history and fracture history) are not collected for children and adolescents in NHANES. Restricting the analytic sample to adults ensures consistent measurement of all indicators and avoids misclassification due to age-based survey skip patterns.\nFurthermore, a small number of observations (n = 11) had missing body mass index values. These cases were retained in the analysis, with the low-BMI risk proxy conservatively defaulted to absent to avoid inflating risk estimates.\n\n\nShow code\n# Filtering out children and mutating NA for low BMI to 0\ndata %&lt;&gt;%\n  dplyr::filter(RIDAGEYR &gt;= 20)\n\n\n\n\nMissingness check\n\n\nShow code\n# Overall missingness summary\nna_summary &lt;- data %&gt;%\n  summarise(\n    total_cells = n() * ncol(data),\n    total_missing = sum(is.na(.)),\n    pct_missing = round(100 * total_missing / total_cells, 2)\n  )\n\nkable(na_summary, col.names = c(\"Total Cells\", \"Total Cells Missing\", \"% Missing\"), caption = \"Overall Missing Cells Summary\")\n\n\n\nOverall Missing Cells Summary\n\n\nTotal Cells\nTotal Cells Missing\n% Missing\n\n\n\n\n68354\n3264\n4.78\n\n\n\n\n\nVariable-level missingness\n\n\nShow code\n# Variable-level missingness\nna_check &lt;- data %&gt;%\n # select(-SMD030, -SMQ040) %&gt;%   # exclude smoking follow-ups\n  summarise(across(\n    everything(),\n    ~ sum(is.na(.)),\n    .names = \"na_{.col}\"\n  )) %&gt;%\n  pivot_longer(\n    everything(),\n    names_to = \"variable\",\n    values_to = \"missing_n\"\n  ) %&gt;%\n  mutate(\n    variable = gsub(\"^na_\", \"\", variable),\n    pct_missing = round(100 * missing_n / nrow(data), 2)\n  ) %&gt;%\n  arrange(desc(missing_n))\n\nkable(na_check, col.names = c(\"Variable\", \"Missing Count\", \"% Missing\"), caption = \"Variable-level Missing Cells Summary\")\n\n\n\nVariable-level Missing Cells Summary\n\n\nVariable\nMissing Count\n% Missing\n\n\n\n\nSMD030\n1619\n52.11\n\n\nSMQ040\n1619\n52.11\n\n\nBMXBMI\n12\n0.39\n\n\nlow_bmi\n12\n0.39\n\n\nsmoker_status\n2\n0.06\n\n\nSEQN\n0\n0.00\n\n\nRIDAGEYR\n0\n0.00\n\n\nRIAGENDR\n0\n0.00\n\n\nRIDRETH1\n0\n0.00\n\n\nWTMEC2YR\n0\n0.00\n\n\nDXXLSBMD\n0\n0.00\n\n\ntscore_spine\n0\n0.00\n\n\nspine_class\n0\n0.00\n\n\nOSQ010A\n0\n0.00\n\n\nOSQ010B\n0\n0.00\n\n\nOSQ010C\n0\n0.00\n\n\nOSQ060\n0\n0.00\n\n\nprior_fracture\n0\n0.00\n\n\nSMQ020\n0\n0.00\n\n\nPAD200\n0\n0.00\n\n\nPAD320\n0\n0.00\n\n\nlow_activity\n0\n0.00\n\n\n\n\n\nThe missingness in the smoking-related variables (SMD030 & SMD030) are not problematic as they are automatically NA if the individual has NOT smoked more than 100 cigarettes in their lifetime making them a non-smoker in the smoker_status variable.\nA small number of observations (n = 12) had missing body mass index values. These cases were retained in the analysis, with the low-BMI risk proxy conservatively defaulted to absent to avoid inflating risk estimates.\nThe two individuals who selected “Don’t know” in relation to their smoking habits have been retained and smoking status conservatively defaulted to absent to avoid inflating risk estimates.\n\n\nShow code\n# Mutating NA for low BMI to 0 and NA smoking status to 0\ndata %&lt;&gt;%\n  mutate(\n    low_bmi = if_else(is.na(low_bmi), 0, low_bmi),\n    smoker_status = if_else(is.na(smoker_status), 0, smoker_status)\n  )\n\n\n\n\n\nAnalysis\n\nDefining cohorts\nThree cohorts were defined to support evaluation of bone-health risk and screening gaps. Cohort definitions were based on age- and gender-based screening recommendations, bone mineral density measurements, and established clinical and lifestyle risk indicators. All cohorts were constructed for population-level analysis and are intended to support risk stratification rather than individual diagnosis.\nCohort 1: Screening-Eligible\nIndividuals were classified as screening-eligible based on age- and gender-based guideline thresholds. Women aged 65 years and older and men aged 70 years and older were considered eligible for routine osteoporosis screening. This cohort represents the population that would typically be identified for screening under current age-based recommendations.\nCohort 2: High Bone Risk\nIndividuals were classified as high bone risk using a lumbar spine T-score–led definition. Participants with a lumbar spine T-score in the osteoporosis range (≤ −2.5) were classified as high risk regardless of other factors. Participants with a lumbar spine T-score in the osteopenia range (between −1.0 and −2.5) were classified as high risk only if at least one additional risk indicator was present. Risk indicators included low body mass index, current or former smoking, a history of fracture at the hip, wrist, or spine, or low levels of physical activity. This approach recognizes that moderately reduced bone density becomes more important when combined with other risk factors.\nCohort 3: Missed High Risk\nThe missed high-risk cohort was defined as individuals who met the criteria for high bone risk but did not meet age-based screening eligibility criteria. This cohort represents individuals with clinically meaningful bone-health risk who would be unlikely to be identified through routine screening under current guidelines.\nTogether, these cohorts enable comparison between guideline-based screening practices and bone-density-informed risk, highlighting populations that may be under-identified for bone-health assessment.\n\n\nShow code\n# Defining Cohorts\n\n# Creating 3 new variables for 3 cohorts (screen eligible, high bone risk, missed high risk)\ndata %&lt;&gt;%\n  mutate(\n    screening_eligible = if_else(\n      (RIAGENDR == 2 & RIDAGEYR &gt;= 65) |\n      (RIAGENDR == 1 & RIDAGEYR &gt;= 70),\n      1, 0                                                     # eligible = 1, not eligible = 0 \n    ),\n      high_bone_risk = if_else(\n      spine_class == 2 |                                       # DXA lumbar risk (osteoporosis)\n      (spine_class == 1 & (                                    # DXA lumbar risk (osteopenia and one other risk factor)\n        coalesce(low_bmi, 0) == 1 |                            # BMI\n        smoker_status %in% c(1, 2) |                           # smoking status\n        coalesce(prior_fracture, 0) == 1 |                     # Previous fracture\n        (coalesce(PAD200, 2) == 2 & coalesce(PAD320, 2) == 2)  # no vigorous AND no moderate activity\n      )),\n      1, 0                                                     # at risk = 1, not at risk = 0\n    ),\n    missed_high_risk = if_else(high_bone_risk == 1 & screening_eligible == 0, 1, 0)  # missed risk = 1, not missed risk = 0\n  )\n\n\n# Creating expanded group variables\ndata %&lt;&gt;%\n  mutate(\n    group = case_when(\n      high_bone_risk == 1 & screening_eligible == 0 ~ \"Missed high risk\",\n      high_bone_risk == 1 & screening_eligible == 1 ~ \"High risk – screening eligible\",\n      high_bone_risk == 0 & screening_eligible == 1 ~ \"Screening eligible – low risk\",\n      high_bone_risk == 0 & screening_eligible == 0 ~ \"Low risk – not screening eligible\",\n      TRUE ~ \"Unknown\"\n    )\n  )\n\n\n\n\n\nReporting\nThis analysis is interested in three groups of individuals and their overlap, (1) those who are screening eligible based on current age-based criteria, (2) those who are not screening eligible, and (3) those who are at high bone risk based on various clinical and lifestyle factors (defined above). There is an overlap between those who are eligible and at risk, but the key overlap is those who are not eligible but are at risk. This is what defines Cohort 3, the missed high-risk individuals who are overlooked by the current age-based screening criteria. The following narratives, tables and visuals aim to examine this.\nThe table below shows the counts and percent of the total population that make up these groups and overlaps.\n\n\nShow code\n# Count table\noverlap_table &lt;- tibble(\n  Group = c(\n    \"Screening eligible\",\n    \"Not screening eligible\",\n    \"High bone risk\",\n    \"Screening eligible AND high bone risk\",\n    \"Not screening eligible AND high bone risk (missed high risk)\"\n  ),\n  Count = c(\n    sum(data$screening_eligible == 1, na.rm = TRUE),\n    sum(data$screening_eligible == 0, na.rm = TRUE),\n    sum(data$high_bone_risk == 1, na.rm = TRUE),\n    sum(data$screening_eligible == 1 & data$high_bone_risk == 1, na.rm = TRUE),\n    sum(data$screening_eligible == 0 & data$high_bone_risk == 1, na.rm = TRUE)\n  )\n) %&gt;%\n  mutate(\n    `Percent of total (%)` = round(100 * Count / nrow(data), 2)\n  )\n\nkable(\n  overlap_table,\n  col.names = c(\"Group\", \"Count\", \"Percent of total (%)\"),\n  align = c(\"l\", \"r\", \"r\"),\n  caption = \"Population groups and overlaps between screening eligibility and high bone risk\"\n)\n\n\n\nPopulation groups and overlaps between screening eligibility and high bone risk\n\n\n\n\n\n\n\nGroup\nCount\nPercent of total (%)\n\n\n\n\nScreening eligible\n125\n4.02\n\n\nNot screening eligible\n2982\n95.98\n\n\nHigh bone risk\n540\n17.38\n\n\nScreening eligible AND high bone risk\n32\n1.03\n\n\nNot screening eligible AND high bone risk (missed high risk)\n508\n16.35\n\n\n\n\n\n\n\nShow code\n# Creating necessary plotting variables (character variables for gender and race, age bands)\ndata %&lt;&gt;%\n  mutate(\n    gender = if_else(RIAGENDR == 2, \"Female\", \"Male\"),\n\n    screening_group = if_else(\n      screening_eligible == 1,\n      \"Screening-eligible\",\n      \"Not screening-eligible\"\n    ),\n\n    age_band = cut(\n      RIDAGEYR,\n      breaks = c(0, 49, 59, 64, 69, 79, Inf),\n      labels = c(\"&lt;50\", \"50–59\", \"60–64\", \"65–69\", \"70–79\", \"80+\"),\n      right = TRUE\n    ),\n\n    race = case_when(\n      RIDRETH1 == 1 ~ \"Mexican American\",\n      RIDRETH1 == 2 ~ \"Other Hispanic\",\n      RIDRETH1 == 3 ~ \"Non-Hispanic White\",\n      RIDRETH1 == 4 ~ \"Non-Hispanic Black\",\n      RIDRETH1 == 5 ~ \"Other / Multi-racial\",\n      TRUE ~ NA_character_\n    )\n  )\n\n\n\nCohort Sizes\nThe below table summarizes the prevalence of each cohort, screening eligible, high bone-health risk, and missed high-risk individuals, in the analytic population. Only 4.02% (125) of the total population (N = 3107) were eligible for screening based on current age-based screening criteria. A larger portion (17.38%) were classified as having high bone-health risk based on the above cohort definitions. 16.35% were classified as missed high risk as they did not meet current age-based screening criteria but were classified as high bone risk. This highlights a significant gap in which a large proportion of high-risk individuals fall outside current age-based screening criteria.\n\n\nShow code\n# Core Cohort sizes\ncore_cohorts &lt;- tibble(\n  Cohort = c(\n    \"Screening eligible\",\n    \"High bone risk\",\n    \"Missed high risk\"\n  ),\n  Count = c(\n    sum(data$screening_eligible == 1, na.rm = TRUE),\n    sum(data$high_bone_risk == 1, na.rm = TRUE),\n    sum(data$missed_high_risk == 1, na.rm = TRUE)\n  )\n) %&gt;%\n  mutate(\n    `Percent (%)` = round(100 * Count / nrow(data), 2)\n  )\n\nkable(core_cohorts, col.names = c(\"Cohort\", \"Count\", \"Percent (%)\"), caption = \"Core cohort sizes and prevalence\")\n\n\n\nCore cohort sizes and prevalence\n\n\nCohort\nCount\nPercent (%)\n\n\n\n\nScreening eligible\n125\n4.02\n\n\nHigh bone risk\n540\n17.38\n\n\nMissed high risk\n508\n16.35\n\n\n\n\n\nThe below plot shows the proportion of individuals classified as high bone risk within each screening eligibility group (screening-eligible, not screening-eligible) as well as within the total population.\nIn particular, it highlights that a substantial portion of those who are not age-eligible for screening meet high-risk criteria. Of the 125 individuals who were screening eligible, 25.6% were also high bone risk. Of the sample that is not eligible for screening, 17% is at high bone-health risk. Similalry, 17.4% of the total sample is a high bone-health risk.\n\n\nShow code\n# Risk Composition by Screening Eligibility\nplot1 &lt;- data %&gt;%\n  mutate(\n    screening_group = if_else(\n      screening_eligible == 1,\n      \"Screening-eligible\",\n      \"Not screening-eligible\"\n    ),\n    risk_group = if_else(\n      high_bone_risk == 1,\n      \"High bone-health risk\",\n      \"Not at risk\"\n    )\n  ) %&gt;%\n  # Create total population rows\n  bind_rows(\n    data %&gt;%\n      mutate(\n        screening_group = \"Total population\",\n        risk_group = if_else(\n          high_bone_risk == 1,\n          \"High bone-health risk\",\n          \"Not at risk\"\n        )\n      )\n  ) %&gt;%\n  count(screening_group, risk_group) %&gt;%\n  group_by(screening_group) %&gt;%\n  mutate(pct = n / sum(n)) %&gt;%\n  ungroup() %&gt;%\n  mutate(\n    screening_group = factor(\n      screening_group,\n      levels = c(\n        \"Screening-eligible\",\n        \"Not screening-eligible\",\n        \"Total population\"\n      )\n    )\n  )\n\n\n# Rendering plot\nggplot(plot1, aes(x = screening_group, y = pct, fill = risk_group)) +\n  geom_col(width = 0.7, color = \"white\", linewidth = 0.5) +\n  geom_text(\n    aes(label = percent(pct, accuracy = 0.1)),\n    position = position_stack(vjust = 0.5),\n    size = 4\n  ) +\n  scale_y_continuous(labels = percent_format(accuracy = 1)) +\n  scale_fill_manual(\n    values = c(\n      \"High bone-health risk\" = \"#6A1B9A\",  # deep purple\n      \"Not at risk\" = \"#9A4EAE\"             # lighter purple\n    )\n  ) +\n  labs(\n    title = \"Composition of Bone-Health Risk by Screening Status\",\n    subtitle = \"Includes screening-eligible, non-eligible, and total population\",\n    x = NULL,\n    y = \"Proportion of group\",\n    fill = NULL\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    axis.text.x = element_text(face = \"bold\"),\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\nSegment Ranking\nThe table below presents age- and gender-specific segment sizes alongside corresponding rates of screening eligible, high bone risk and missed high risk. This view highlights how both the magnitude and concentration of missed bone-health risk vary across demographic groups under current screening criteria.\nThe table shows that all screening eligible individuals come from a single demographic group, females ages 65-69. It also highlights which demographic groups have large missed high risk rates (such as females aged 60-64 [38.6%], females aged 50-59 [24.5%]).\n\n\nShow code\n# Segment ranking (what population groups are most affect)\n\n# Preparing demographic variables\ndata %&lt;&gt;%\n  mutate(\n    gender = factor(if_else(RIAGENDR == 2, \"Female\", \"Male\"),\n                 levels = c(\"Female\", \"Male\")),\nage_band = cut(\n      RIDAGEYR,\n      breaks = c(0, 49, 59, 64, 69, 79, Inf),\n      labels = c(\"&lt;50\", \"50\\u201159\", \"60\\u201164\", \"65\\u201169\", \"70\\u201179\", \"80+\"),\n      right = TRUE\n    ),\n    age_band = factor(\n      age_band,\n      levels = c(\"&lt;50\", \"50\\u201159\", \"60\\u201164\", \"65\\u201169\", \"70\\u201179\", \"80+\"),\n      ordered = TRUE\n    )\n  )\n\n# Preparing data\nsegment_core &lt;- data %&gt;%\n  group_by(age_band, gender) %&gt;%\n  summarise(\n    n = n(),\n    screening_eligible_n = sum(screening_eligible == 1, na.rm = TRUE),\n    screening_eligible_rate = screening_eligible_n / n,\n    high_risk_n = sum(high_bone_risk == 1, na.rm = TRUE),\n    high_risk_rate = high_risk_n / n,\n    missed_high_risk_n = sum(missed_high_risk == 1, na.rm = TRUE),\n    missed_high_risk_rate = missed_high_risk_n / n,\n\n    .groups = \"drop\"\n  )\n\n# Making table\nkable(\n  segment_core %&gt;%\n    mutate(\n      screening_eligible_rate = percent(screening_eligible_rate, accuracy = 0.1),\n      high_risk_rate = percent(high_risk_rate, accuracy = 0.1),\n      missed_high_risk_rate = percent(missed_high_risk_rate, accuracy = 0.1)\n    ),\n  col.names = c(\n    \"Age Band\",\n    \"Gender\",\n    \"Population (N)\",\n    \"Screening Eligible (N)\",\n    \"Screening Eligible Rate\",\n    \"High Bone Risk (N)\",\n    \"High Bone Risk Rate\",\n    \"Missed High Risk (N)\",\n    \"Missed High Risk Rate\"\n  ),\n   align = c(\"l\", \"l\", \"r\", \"r\", \"r\", \"r\", \"r\", \"r\", \"r\"),\n  caption = \"Segment ranking by age band and gender using core cohort definitions\"\n)\n\n\n\nSegment ranking by age band and gender using core cohort definitions\n\n\n\n\n\n\n\n\n\n\n\n\n\nAge Band\nGender\nPopulation (N)\nScreening Eligible (N)\nScreening Eligible Rate\nHigh Bone Risk (N)\nHigh Bone Risk Rate\nMissed High Risk (N)\nMissed High Risk Rate\n\n\n\n\n&lt;50\nFemale\n933\n0\n0.0%\n93\n10.0%\n93\n10.0%\n\n\n&lt;50\nMale\n1027\n0\n0.0%\n171\n16.7%\n171\n16.7%\n\n\n50‑59\nFemale\n282\n0\n0.0%\n69\n24.5%\n69\n24.5%\n\n\n50‑59\nMale\n279\n0\n0.0%\n54\n19.4%\n54\n19.4%\n\n\n60‑64\nFemale\n166\n0\n0.0%\n64\n38.6%\n64\n38.6%\n\n\n60‑64\nMale\n154\n0\n0.0%\n28\n18.2%\n28\n18.2%\n\n\n65‑69\nFemale\n125\n125\n100.0%\n32\n25.6%\n0\n0.0%\n\n\n65‑69\nMale\n141\n0\n0.0%\n29\n20.6%\n29\n20.6%\n\n\n\n\n\nThe heatmap below is a visual representation of this, highlighting age–gender segments with the greatest screening gaps, where a higher portion of high-risk individuals are not captured by current age-based screening criteria. Color intensity reflects the magnitude of missed high-risk prevalence within each segment.\n\n\nShow code\n# Missed High-Risk Heatmap\nplot2 &lt;- data %&gt;%\n  group_by(age_band, gender) %&gt;%\n  summarise(missed_rate = mean(missed_high_risk, na.rm = TRUE),\n            n = n(),\n            .groups = \"drop\")\n\n# Rendering plot\nggplot(plot2, aes(x = age_band, y = gender, fill = missed_rate)) +\n  geom_tile(color = \"white\", linewidth = 0.4) +\n  geom_text(\n    aes(label = percent(missed_rate, accuracy = 0.1)),\n    size = 3.8,\n    color = \"black\"\n  ) +\n  scale_fill_gradient(\n    low = \"#F3E5F5\",   # very light purple\n    high = \"#6A1B9A\",  # deep purple\n    labels = percent_format(accuracy = 1)\n  ) +\n  labs(\n    title = \"Missed High-Risk Rate by Age Band and Gender\",\n    subtitle = \"Proportion of high-risk individuals not captured by age-based screening\",\n    x = \"Age band\",\n    y = NULL,\n    fill = \"Missed high-risk rate\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    panel.grid = element_blank(),\n    plot.title = element_text(face = \"bold\"),\n    axis.text.x = element_text(face = \"bold\"),\n    axis.text.y = element_text(face = \"bold\"),\n    legend.title = element_text(face = \"bold\")\n  )\n\n\n\n\n\n\n\n\n\n\n\nRisk Factor Prevalence (Total Sample)\nThe table below summarizes the prevalence of selected clinical and lifestyle risk factors related to bone health across the analytic population. Values represent the percentage of individuals exhibiting each risk factor and provide context for subsequent cohort and driver analyses.\nIn the total sample, reduced bone density was common, with of individuals classified as having lumbar spine osteopenia and a further 13% meeting criteria for osteoporosis. Behavioral and clinical risk factors were also prevalent, including smoking (26%), low physical activity (25%), and prior fracture history (12%), underscoring the multifaceted nature of bone-health risk beyond age alone.\n\n\nShow code\n# Risk factor prevalence in the population\nrisk_summary &lt;- data %&gt;%\n  summarise(\n    low_bmi = mean(low_bmi == 1, na.rm = TRUE),\n    osteopenia = mean(spine_class == 1, na.rm = TRUE),\n    osteoporosis = mean(spine_class == 2, na.rm = TRUE),\n    smoker = mean(smoker_status %in% c(1, 2), na.rm = TRUE),\n    prior_fracture = mean(prior_fracture == 1, na.rm = TRUE),\n    low_activity = mean(PAD200 == 2 & PAD320 == 2, na.rm = TRUE)\n  ) %&gt;%\n  pivot_longer(everything(),\n               names_to = \"driver\",\n               values_to = \"prevalence\") %&gt;%\n  mutate(prevalence = round(prevalence, 2),    \n         prevalence = percent(prevalence)\n  ) %&gt;% \n   mutate(\n    driver = recode(\n      driver,\n      low_bmi        = \"Low body mass index (BMI &lt; 18.5)\",\n      osteopenia    = \"Lumbar spine osteopenia (T-score −1.0 to −2.5)\",\n      osteoporosis  = \"Lumbar spine osteoporosis (T-score ≤ −2.5)\",\n      smoker        = \"Current or former smoker\",\n      prior_fracture= \"Prior fracture (hip, wrist, or spine)\",\n      low_activity  = \"Low physical activity\"\n    )\n  )\n\nkable(risk_summary, col.names = c(\"Driver\", \"Prevalence\"), caption = \"Risk Factor Prevalence in the Total Sample\")\n\n\n\nRisk Factor Prevalence in the Total Sample\n\n\nDriver\nPrevalence\n\n\n\n\nLow body mass index (BMI &lt; 18.5)\n2%\n\n\nLumbar spine osteopenia (T-score −1.0 to −2.5)\n22%\n\n\nLumbar spine osteoporosis (T-score ≤ −2.5)\n2%\n\n\nCurrent or former smoker\n48%\n\n\nPrior fracture (hip, wrist, or spine)\n12%\n\n\nLow physical activity\n33%\n\n\n\n\n\n\n\nRisk Factor Prevalence (High-Risk Sample)\nThe table below summarizes the prevalence of selected clinical and lifestyle risk factors related to bone health across the high-risk sample. Values represent the percentage of individuals exhibiting each risk factor and provide context for subsequent cohort and driver analyses. Among individuals classified as high bone risk, reduced bone density was dominant, with more than half meeting criteria for lumbar spine osteoporosis and 46% exhibiting osteopenia. Lifestyle and clinical risk factors remained highly prevalent, particularly low physical activity (39%), low body mass index (37%), current or former smoker (23%) and prior fracture history (22%), highlighting multiple, overlapping contributors to elevated bone-health risk.\n\n\nShow code\n# Risk factor prevalence in the high risk sample\nrisk_summary &lt;- data %&gt;%\n  filter(high_bone_risk == 1) %&gt;%\n  summarise(\n    low_bmi = mean(low_bmi == 1, na.rm = TRUE),\n    osteopenia = mean(spine_class == 1, na.rm = TRUE),\n    osteoporosis = mean(spine_class == 2, na.rm = TRUE),\n    smoker = mean(smoker_status %in% c(1, 2), na.rm = TRUE),\n    prior_fracture = mean(prior_fracture == 1, na.rm = TRUE),\n    low_activity = mean(PAD200 == 2 & PAD320 == 2, na.rm = TRUE)\n  ) %&gt;%\n  pivot_longer(everything(),\n               names_to = \"driver\",\n               values_to = \"prevalence\") %&gt;%\n  mutate(prevalence = round(prevalence, 2),    \n         prevalence = percent(prevalence)\n  ) %&gt;% \n   mutate(\n    driver = recode(\n      driver,\n      low_bmi        = \"Low body mass index (BMI &lt; 18.5)\",\n      osteopenia    = \"Lumbar spine osteopenia (T-score −1.0 to −2.5)\",\n      osteoporosis  = \"Lumbar spine osteoporosis (T-score ≤ −2.5)\",\n      smoker        = \"Current or former smoker\",\n      prior_fracture= \"Prior fracture (hip, wrist, or spine)\",\n      low_activity  = \"Low physical activity\"\n    )\n  )\n\nkable(risk_summary, col.names = c(\"Driver\", \"Prevalence\"), caption = \"Risk Factor Prevalence in the High-Risk Sample\")\n\n\n\nRisk Factor Prevalence in the High-Risk Sample\n\n\nDriver\nPrevalence\n\n\n\n\nLow body mass index (BMI &lt; 18.5)\n3%\n\n\nLumbar spine osteopenia (T-score −1.0 to −2.5)\n87%\n\n\nLumbar spine osteoporosis (T-score ≤ −2.5)\n13%\n\n\nCurrent or former smoker\n66%\n\n\nPrior fracture (hip, wrist, or spine)\n22%\n\n\nLow physical activity\n50%\n\n\n\n\n\nThe below plot summarizes the distribution of key risk factors within the high-bone-risk cohort, illustrating which characteristics are most prevalent among individuals at elevated fracture risk. The results provide context for understanding how risk accumulates beyond bone density alone. Osteopenia and osteoporosis are not shown in this figure because bone density categories were used to define the high-risk cohort; the chart focuses on additional clinical and lifestyle risk factors present within that group.\n\n\nShow code\n# Risk Factor Prevalence (High-Risk Sample) plot\nplot3 &lt;- data %&gt;%\n  filter(high_bone_risk == 1) %&gt;%\n  summarise(\n    `Low BMI (&lt;18.5)` = mean(low_bmi == 1, na.rm = TRUE),\n    `Current/Former smoker` = mean(smoker_status %in% c(1, 2), na.rm = TRUE),\n    `Prior fracture (hip/wrist/spine)` = mean(prior_fracture == 1, na.rm = TRUE),\n    `Low activity` = mean(PAD200 == 2 & PAD320 == 2, na.rm = TRUE)\n  ) %&gt;%\n  pivot_longer(everything(), names_to = \"driver\", values_to = \"rate\") %&gt;%\n  arrange(rate)\n\nmax_rate &lt;- max(plot3$rate, na.rm = TRUE)\n\nggplot(plot3, aes(x = rate, y = reorder(driver, rate))) +\n  geom_col(width = 0.7, fill = \"#9A4EAE\", color = \"#593163\", linewidth = 0.8) +\n  geom_text(aes(label = percent(rate, accuracy = 0.1)),\n            hjust = -0.1, size = 3.8) +\n  scale_x_continuous(\n    labels = percent_format(accuracy = 1),\n    limits = c(0, ifelse(is.finite(max_rate), max_rate * 1.15, 1))\n  ) +\n  labs(\n    title = \"Risk Driver Prevalence Among High-Risk Individuals\",\n    subtitle = \"Proportion of the high-risk cohort exhibiting each risk factor\",\n    x = \"Prevalence within high-risk cohort\",\n    y = NULL\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    axis.text.y = element_text(face = \"bold\"),\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\nExpanded Screening Logic Scenario\nThis below plot shows how different screening scenarios affect the proportion of high-risk individuals who would not be identified for screening. Individual-level screening eligibility was recalculated under each scenario, and the resulting missed high-risk rates were summarized at the population level to quantify the potential impact of expanding screening criteria.\nBaseline: “What % of people are high risk and missed today (female &gt;= 65, male &gt;= 70)?”\nAge-expanded: “What % would still be missed if we lowered age thresholds (female &gt;= 60, male &gt;= 65)?”\nRisk-proxy: “What % would still be missed if we screened anyone with a risk proxy (smoker, low BMI, low activity, prior fracture)?”\nRisk-proxy individual risks: “What % would still be missed if we screened anyone with one of the risk proxies (smoker, low BMI, low activity, prior fracture)?”\nThe below plot shows the proportion of the total population that is both high bone risk and not screening-eligible under the various scenarios.\nUnder current age-based screening criteria, approximately 26.8% of the total population is classified as high bone risk yet would not be identified for screening, indicating a substantial screening gap. Modest age-based expansion reduces this missed high-risk prevalence only marginally (to 25.1%), suggesting that age thresholds alone have limited impact. In contrast, screening triggered by simple risk proxies—such as smoking history, low BMI, low physical activity, or prior fracture—dramatically reduces the missed high-risk population to near zero, highlighting the potential value of risk-informed screening strategies over age-only approaches.\n\n\nShow code\n# Defining Scenarios\ndata %&lt;&gt;%\n  mutate(\n    # Baseline screening eligibility (original definition)\n    screening_baseline = if_else(\n      (RIAGENDR == 2 & RIDAGEYR &gt;= 65) |\n      (RIAGENDR == 1 & RIDAGEYR &gt;= 70),\n      1, 0\n    ),\n\n    # Age expanded scenario\n    screening_age_expanded = if_else(\n      (RIAGENDR == 2 & RIDAGEYR &gt;= 60) |\n      (RIAGENDR == 1 & RIDAGEYR &gt;= 65),\n      1, 0\n    ),\n\n    # Expanded risk proxies scenario (ANY of these triggers screening)\n    screening_risk_proxy = if_else(\n      (smoker_status %in% c(1, 2)) |\n      (low_bmi == 1) |\n      (low_activity == 1) |\n      (prior_fracture == 1),\n      1, 0\n    ),\n    \n    # Expanded risk proxies scenario (smoking)\n    screening_risk_proxy_smoking = if_else(\n      (smoker_status %in% c(1, 2)),\n      1, 0\n    ),\n    \n  \n    # Expanded risk proxies scenario (Low BMI)\n    screening_risk_proxy_bmi = if_else(\n      (low_bmi == 1),\n      1, 0\n    ),  \n    \n    # Expanded risk proxies scenario (Low Activity)\n    screening_risk_proxy_activity = if_else(\n      (low_activity == 1),\n      1, 0\n    ),\n    \n    # Expanded risk proxies scenario (Prior Fracture)\n    screening_risk_proxy_fracture = if_else(\n      (prior_fracture == 1),\n      1, 0\n    ),\n\n    # Missed high-risk under each definition (high risk but NOT eligible)\n    missed_baseline = if_else(high_bone_risk == 1 & screening_baseline == 0, 1, 0),\n    missed_age_expanded = if_else(high_bone_risk == 1 & screening_age_expanded == 0, 1, 0),\n    missed_risk_proxy = if_else(high_bone_risk == 1 & screening_risk_proxy == 0, 1, 0),\n    missed_risk_proxy_smoking = if_else(high_bone_risk == 1 & screening_risk_proxy_smoking == 0, 1, 0),\n    missed_risk_proxy_lowBMI = if_else(high_bone_risk == 1 & screening_risk_proxy_bmi == 0, 1, 0),\n    missed_risk_proxy_low_activity = if_else(high_bone_risk == 1 & screening_risk_proxy_activity == 0, 1, 0),\n    missed_risk_proxy_prior_fracture = if_else(high_bone_risk == 1 & screening_risk_proxy_fracture == 0, 1, 0)\n  )\n\n\n# Measuring the impact of the scenarios - Proportion of the entire population that is both high bone risk and not screening-eligible under a given scenario.\nplot4 &lt;- tibble(\n  scenario = c(\n    \"Baseline (F&gt;=65, M&gt;=70)\",\n    \"Age-expanded (F&gt;=60, M&gt;=65)\",\n    \"Risk-proxy (smoke/BMI/activity/fracture)\",\n    \"Risk-proxy (smoking)\",\n    \"Risk-proxy (BMI)\",\n    \"Risk-proxy (activity/)\",\n    \"Risk-proxy (fracture)\"\n  ),\n  missed_rate = c(\n    mean(data$missed_baseline, na.rm = TRUE),\n    mean(data$missed_age_expanded, na.rm = TRUE),\n    mean(data$missed_risk_proxy, na.rm = TRUE),\n    mean(data$missed_risk_proxy_smoking, na.rm = TRUE),\n    mean(data$missed_risk_proxy_lowBMI, na.rm = TRUE),\n    mean(data$missed_risk_proxy_low_activity, na.rm = TRUE),\n    mean(data$missed_risk_proxy_prior_fracture, na.rm = TRUE)\n  )\n) %&gt;%\n  mutate(\n    scenario = factor(\n      scenario,\n      levels = c(\n        \"Baseline (F&gt;=65, M&gt;=70)\",\n        \"Age-expanded (F&gt;=60, M&gt;=65)\",\n        \"Risk-proxy (smoke/BMI/activity/fracture)\",\n        \"Risk-proxy (smoking)\",\n        \"Risk-proxy (BMI)\",\n        \"Risk-proxy (activity/)\",\n        \"Risk-proxy (fracture)\"\n      )\n    )\n  )\n\n\n# Rendering the plot\nggplot(plot4, aes(x = scenario, y = missed_rate)) +\n  geom_col(\n    width = 0.65,\n    fill = \"#9A4EAE\",     # light purple\n    color = \"#593163\",    # dark purple outline\n    linewidth = 0.9\n  ) +\n  geom_text(\n    aes(label = percent(missed_rate, accuracy = 0.1)),\n    vjust = -0.5,\n    size = 4\n  ) +\n  scale_y_continuous(\n    labels = percent_format(accuracy = 1),\n    limits = c(0, max(plot4$missed_rate, na.rm = TRUE) * 1.2)\n  ) +\n  labs(\n    title = \"Expanded Screening Comparison\",\n    subtitle = \"Comparing baseline age-based screening vs expanded screening logic\",\n    x = NULL,\n    y = \"Missed high-risk rate\"\n  ) +\n  theme_minimal(base_size = 13)+\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    axis.text.x = element_text(\n      face = \"bold\",\n      angle = 40,     # rotate labels\n      hjust = 1,      # right-align\n      vjust = 1\n    ),\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor = element_blank()\n  )\n\n\n\n\n\n\n\n\n\n\n\nRacial Equity Plot\nThe below plot compares the population-level missed high-risk rate across racial groups, with the dashed line indicating the overall sample average. The figure is intended as an equity guardrail, highlighting whether missed high-risk prevalence differs meaningfully across groups rather than to support causal interpretation.\nMissed high-risk prevalence varies across racial groups, with Mexican American and Other/Multiracial populations showing higher-than-average missed rates, while Non-Hispanic Black individuals fall below the overall mean. Overall, the differences suggest that the screening gap is present across all groups, with some variation in magnitude rather than concentration in a single population.\n\n\nShow code\n# Racial Equity Plot\nequity_bar &lt;- data %&gt;%\n  group_by(race) %&gt;%\n  summarise(\n    missed_rate = mean(missed_high_risk, na.rm = TRUE),\n    n = n(),\n    .groups = \"drop\"\n  )\n\n# Overall missed average\noverall_missed &lt;- mean(data$missed_high_risk, na.rm = TRUE)\n\n# Rendering plot\nggplot(equity_bar, aes(x = race, y = missed_rate)) +\n  geom_col(fill = \"#9A4EAE\",     # light purple\n    color = \"#593163\",    # dark purple outline\n    alpha = 0.9) +\n  geom_hline(\n    yintercept = overall_missed,\n    linetype = \"dashed\",\n    color = \"black\"\n  ) +\n  geom_text(\n    aes(label = percent(missed_rate, accuracy = 0.1)),\n    vjust = -0.4,\n    size = 3.8\n  ) +\n  scale_y_continuous(labels = percent_format(accuracy = 1)) +\n  labs(\n    title = \"Missed High-Risk Rate by Race/Ethnicity\",\n    subtitle = \"Dashed line indicates overall population average\",\n    x = NULL,\n    y = \"Missed high-risk rate\"\n  ) +\n  theme_minimal(base_size = 13) +\n  theme(\n    plot.title = element_text(face = \"bold\"),\n    axis.text.x = element_text(\n      face = \"bold\",\n      angle = 30,     # rotate labels\n      hjust = 1,      # right-align\n      vjust = 1\n    ),\n    panel.grid.major.x = element_blank()\n    \n  )\n\n\n\n\n\n\n\n\n\n\n\n\nConclusion\nThis analysis demonstrates that current age-based osteoporosis screening criteria are insufficient and capture only a small portion of individuals at elevated bone-health risk, leaving a substantial proportion of high-risk individuals unidentified. Risk is driven by a combination of structural bone deficits and common, readily observable factors such as low BMI, low physical activity, smoking history, and prior fracture history. Modest age-based expansion provides limited improvement, whereas incorporating simple risk proxies substantially reduces missed high-risk prevalence with minimal added complexity. These findings support a shift toward risk-informed screening strategies to improve identification efficiency and reduce preventable fracture risk.\n\n\nReferences\nXue, S., Zhang, Y., Qiao, W., Zhao, Q., Guo, D., Li, B., Shen, X., Feng, L., Huang, F., Wang, N., Oumer, K. S., Getachew, C. T., & Yang, S. (2021). An Updated Reference for Calculating Bone Mineral Density T-Scores. The Journal of Clinical Endocrinology and Metabolism, 106(7), e2613–e2621. https://doi.org/10.1210/clinem/dgab180"
  }
]